<h1>Meetings</h1>

<table class="table">
  <thead>
    <tr>
      <th>User</th>
      <th>Meeting room</th>
      <th>Start time</th>
      <th>End time</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @meetings.each do |meeting| %>
      <tr>
        <td><%= meeting.user %></td>
        <td><%= meeting.meeting_room %></td>
        <td><%= meeting.start_time %></td>
        <td><%= meeting.end_time %></td>
        <td><%= link_to 'Show', meeting %></td>
        <td><%= link_to 'Edit', edit_meeting_path(meeting) %></td>
        <td><%= link_to 'Destroy', meeting, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="container">
    <div class="row">
      <% @meeting_rooms.each do |meeting_room| %>
        <div id="<%= dom_id(meeting_room) %>" class="col col-xs-4 col-sm-4 col-md-4 col-lg-4 meeting-day-detail">
          <%= render "room_day", day: DateTime.now, room: meeting_room %>
        </div>
<% Rails.logger.info(dom_id(meeting_room)) %>
        <script type="text/javascript">
          <%
            meetings = meeting_room.meetings.collect do |m|
              { start_hour: m.start_time.hour,
                start_min: m.start_time.min,
                end_hour: m.end_time.hour,
                end_min: m.end_time.min }
            end
          %>
          var meetings = <%= meetings.to_json.html_safe %>
          MeetingRoomApp.drawMeetings('<%= dom_id(meeting_room) %>', meetings)
        </script>

      <% end %>
    </div>
</div>

<br>

<%= link_to 'New Meeting', new_meeting_path %>

